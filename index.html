<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Accelerometer Example</title>
    <style>
        #object {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: red;
        }
    </style>
</head>

<body>
    <div id="object"></div>
    <div id="Object_x"></div>
    <button id="start_demo">Start Demo</button>

    <script>
        const object = document.getElementById("object");
        let screenWidth = window.innerWidth;
        let screenHeight = window.innerHeight;
        let demoIsActive = false; // Track whether the demo is active

        // Function to center the object on both X and Y axis
        function centerObject() {
            const initialLeft = (screenWidth - object.offsetWidth) / 2;
            const initialTop = (screenHeight - object.offsetHeight) / 2;
            object.style.left = `${initialLeft}px`;
            object.style.top = `${initialTop}px`;
        }

        // Initial centering of the object
        centerObject();

        const moveSpeed = 5; // Speed of object movement

        function handleOrientation(event) {
            if (!demoIsActive) return; // Exit if demo is not active

            const gamma = event.gamma; // Left-to-right tilt in degrees
            // Determine movement direction based on gamma value
            let direction = gamma > 5 ? 1 : gamma < -5 ? -1 : 0;

            // Update object's position at a constant speed
            const currentLeft = parseInt(object.style.left, 10);
            let newLeft = currentLeft + (moveSpeed * direction);

            // Ensure the object remains within screen bounds
            newLeft = Math.max(0, Math.min(screenWidth - object.offsetWidth, newLeft));

            object.style.left = `${newLeft}px`;
        }

        const toggleButton = document.getElementById("start_demo");
        toggleButton.addEventListener("click", function (e) {
            e.preventDefault();
            demoIsActive = !demoIsActive; // Toggle the state of the demo

            if (demoIsActive) {
                // Change button text to "Stop Demo"
                toggleButton.textContent = "Stop Demo";
                // Start listening to device orientation
                startListening();
            } else {
                // Change button text to "Start Demo"
                toggleButton.textContent = "Start Demo";
                // Stop listening to device orientation
                stopListening();
            }
        });

        function startListening() {
            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission().then(response => {
                    if (response == 'granted') {
                        window.addEventListener('deviceorientation', handleOrientation);
                    }
                }).catch(console.error);
            } else {
                window.addEventListener('deviceorientation', handleOrientation);
            }
        }

        function stopListening() {
            window.removeEventListener('deviceorientation', handleOrientation);
        }

        window.addEventListener('resize', () => {
            screenWidth = window.innerWidth;
            screenHeight = window.innerHeight;
            centerObject(); // Re-center the object on resize
        });
    </script>
</body>

</html>